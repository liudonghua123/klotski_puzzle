var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(h,C,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");h!=Array.prototype&&h!=Object.prototype&&(h[C]=k.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global?global:h};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(h,C,k,m){if(C){k=$jscomp.global;h=h.split(".");for(m=0;m<h.length-1;m++){var q=h[m];q in k||(k[q]={});k=k[q]}h=h[h.length-1];m=k[h];C=C(m);C!=m&&null!=C&&$jscomp.defineProperty(k,h,{configurable:!0,writable:!0,value:C})}};$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,k,m){var q=this.length||0;0>k&&(k=Math.max(0,q+k));if(null==m||m>q)m=q;m=Number(m);0>m&&(m=Math.max(0,q+m));for(k=Number(k||0);k<m;k++)this[k]=h;return this}},"es6-impl","es3");
var TABS_TYPE={NORMAL:0,CLASSIC:1,USER:2};
function vSelectBoard(){function h(){var b=new Kinetic.Group({x:T+780-12,y:U+12}),a=new Kinetic.Circle({x:-4,y:4,radius:8,fill:"#F63333",opacity:1}),c=new Kinetic.Circle({x:-4,y:4,radius:8,fill:"#F63333",opacity:0}),d=new Kinetic.Shape({x:-8,y:0,drawFunc:function(a){var b=a.getContext();b.beginPath();b.moveTo(0,0);b.lineTo(8,8);b.closePath();b.moveTo(8,0);b.lineTo(0,8);b.closePath();b.fill();a.fillStroke(this)},stroke:"white",strokeWidth:2});c.on("mouseover",function(){document.body.style.cursor=
"pointer";a.setFill("white");d.setStroke("#F63333");this.getLayer().draw()});c.on("mouseout",function(){document.body.style.cursor="default";a.setFill("#F63333");d.setStroke("white");this.getLayer().draw()});c.on("click tap",function(){null!=V&&ia()});b.add(a);b.add(d);b.add(c);return b}function C(b,a){var c=b.normalCycle,d=b.normalCross,e=b.activeCycle,g=b.activeCross,f=new Kinetic.Group({x:b.x,y:b.y}),x=new Kinetic.Circle({x:-4,y:4,radius:8,fill:c,opacity:1}),v=new Kinetic.Circle({myIdx:a,x:-4,
y:4,radius:8,fill:c,opacity:0}),h=new Kinetic.Shape({x:-8,y:0,drawFunc:function(b){var a=b.getContext();a.beginPath();a.moveTo(0,0);a.lineTo(8,8);a.closePath();a.moveTo(8,0);a.lineTo(0,8);a.closePath();a.fill();b.fillStroke(this)},stroke:d,strokeWidth:2});v.on("mouseover",function(){document.body.style.cursor="pointer";x.setFill(e);h.setStroke(g);n.draw()});v.on("mouseout",function(){document.body.style.cursor="default";x.setFill(c);h.setStroke(d);n.draw()});v.on("click tap",function(){var a=this.getAttr("myIdx");
removeUserDefinedBoard(a);var b=getUserInfo().id,c=getUserInfo().size,d=p.level;if(p.tableId==b&&d>=a+1){switch(!0){case d==a+1:var e,f,g;0>=c?(e=l[0].tableId,f=l[0].level,g=TABS_TYPE.NORMAL):(e=b,g=TABS_TYPE.USER,f=a>=c?a:a+1);break;case d>a+1:e=b,g=TABS_TYPE.USER,f=d-1}(b=ja.changeSelectedBoard({table:e,level:f,board:getBoardInfo(e,f).board,type:g}))?(gCurSelectedBoard=b,d==a+1&&(stepInfo=[],curBoardStep=manualMoveCount=gHintsCount=0,savePlayModeInfo()),savePlayInfo(gCurSelectedBoard,stepInfo,gHintsCount,
manualMoveCount),N=p):error("error ? why? after delete usr board !")}0>=c?(A[w].hide(),D[w].hide(),k(0,0)):(f=a>=c?a:a+1,k(w,Math.floor((f-1)/24)),debug("["+w+","+f+"]"))});f.add(x);f.add(h);f.add(v);return f}function k(b,a){0<=K&&(A[K].setFill("#CCCCCC"),A[K].setStroke("black"),A[K].setStrokeWidth(.2),D[K].setFill("gray"));A[b].setFill("white");A[b].setStroke(null);A[b].setStrokeWidth(0);D[b].setFill("black");K=b;F.draw();n.removeChildren();var c;switch(!0){case b<E:var d=96*b,e=d+96-1;e>=l.length&&
(e=l.length-1);c=Math.ceil((e-d+1)/24);G=-480*(c-1);aa(c);c=e;for(var e=[],g=ba(p.tableId,p.level,TABS_TYPE.NORMAL),f=g.tabsId==b&&3!=I?1:0,g=g.level,x=0;4>x;x++)for(var v=0;4>v;v++)for(var h=0;6>h;h++){var k=6*v+h+24*x,y=k+d;if(y>c)break;var u=120*h+27.5,r=120*v+10+480*x,m=l[y].tableId,y=l[y].level,q=getBoardInfo(m,y),z=getBoardHighScore(m,y),z="undefined"==typeof z?0:score2StarNumber(z,q.mini),t="black";f&&g==k+1&&(t="red");t=new Kinetic.Text({x:u,y:r,text:k+1,fontSize:ca,fontFamily:"arial",fill:t});
n.add(t);da(n,u,r,q.board);ea(n,u,r,z);e[k]=fa(u,r,m,y,b,k+1,TABS_TYPE.NORMAL);n.add(e[k])}break;case b==B:d=getClassicInfo();e=d.id;d=d.list;c=Math.ceil(d.length/24);G=-480*(c-1);aa(c);c=B;f=d.length;g=[];v=ba(p.tableId,p.level,TABS_TYPE.CLASSIC);x=v.tabsId==c&&3!=I?1:0;v=v.level;for(h=0;4>h;h++)for(k=0;4>k;k++)for(u=0;6>u;u++){r=6*k+u+24*h;if(r>=f)break;m=120*u+27.5;y=120*k+10+480*h;q=getBoardInfo(e,d[r]);z=getBoardHighScore(e,d[r]);z="undefined"==typeof z?0:score2StarNumber(z,q.mini);t="black";
x&&v==r+1&&(t="red");t=new Kinetic.Text({x:m,y:y,text:r+1+" "+q.name,fontSize:ca,fontFamily:"arial",fill:t});n.add(t);da(n,m,y,q.board);ea(n,m,y,z);g[r]=fa(m,y,e,d[r],c,r+1,TABS_TYPE.CLASSIC);n.add(g[r])}break;case b==w:e=getUserInfo().id;d=getUserInfo().size;c=Math.ceil(d/24);G=-480*(c-1);aa(c);c=w;f=[];x=ba(p.tableId,p.level,TABS_TYPE.USER);g=x.tabsId==c&&3!=I?1:0;x=x.level;for(v=0;4>v;v++)for(h=0;4>h;h++)for(k=0;6>k;k++){u=6*h+k+24*v;if(u>=d)break;r=120*k+27.5;m=120*h+10+480*v;y=getBoardInfo(e,
u+1);q=getBoardHighScore(e,u+1);q="undefined"==typeof q?0:score2StarNumber(q,y.mini);z="black";g&&x==u+1&&(z="red");z=new Kinetic.Text({x:r,y:m,text:u+1,fontSize:ca,fontFamily:"arial",fill:z});n.add(z);da(n,r,m,y.board);ea(n,r,m,q);f[u]=fa(r,m,e,u+1,c,u+1,TABS_TYPE.USER);r={x:r+80,y:m+4,normalCycle:"#D0D0FF",normalCross:"white",activeCycle:"#F63333",activeCross:"white"};3==I&&(r=C(r,u),n.add(r));n.add(f[u])}break;default:error("showSlideBoardElement(): design error !")}d=n.getPosition();n.setPosition(d.x,
-480*a);n.getLayer().draw()}function m(b){L=new Kinetic.Stage({container:b,width:740,height:525});F=new Kinetic.Layer;L.add(F);for(b=0;b<E+2;b++){var a;a=b<E?"Level "+(b+1):b==B?gTxtMsg.Classic:gTxtMsg.User;A[b]=new Kinetic.Rect({tabsId:b,x:70*b,y:0,width:70,height:25,fill:"#CCCCCC",stroke:"black",strokeWidth:.2});D[b]=new Kinetic.Text({tabsId:b,x:10+70*b,y:5,text:a,fontSize:16,fontFamily:"arial",fill:"gray"});F.add(A[b]);F.add(D[b]);D[b].on("mouseover",function(){document.body.style.cursor="pointer"});
D[b].on("mouseout",function(){document.body.style.cursor="default"});D[b].on("click tap",function(a){k(this.getAttr("tabsId"),0)});A[b].on("mouseover",function(){document.body.style.cursor="pointer"});A[b].on("mouseout",function(){document.body.style.cursor="default"});A[b].on("click tap",function(a){k(this.getAttr("tabsId"),0)})}b=new Kinetic.Rect({x:0,y:24,width:740,height:526,fill:"white"});F.add(b)}function q(b){var a=W.getContext();"undefined"==typeof auto&&(auto=0);W.clear();a.font="12pt arial";
a.fillStyle="blue";a.fillText(b,740,20)}function da(b,a,c,d){for(var e=0,g=[],f=0;f<G_BOARD_X;f++){g[f]=[];for(var h=0;h<G_BOARD_Y;h++)g[f][h]=-1}for(h=0;h<G_BOARD_Y;h++)for(f=0;f<G_BOARD_X;f++)if(0<=g[f][h])e++;else{var k=gBlockBelongTo[d.charCodeAt(e++)-63];if(k){var l=b,m=new Kinetic.Rect({x:a+14+O*f,y:c+17+O*h,width:O*gBlockStyle[k][0],height:O*gBlockStyle[k][1],fill:la[k],stroke:"black",strokeWidth:.3});l.add(m)}for(var l=gBlockStyle[k][0],m=gBlockStyle[k][1],n=0;n<l;n++)for(var p=0;p<m;p++)g[f+
n][h+p]=k}}function ea(b,a,c,d){if(0!=d)for(var e=1;3>=e;e++){var g=new Kinetic.Star({x:a+18*e,y:c+15+O*(G_BOARD_Y+1),numPoints:5,innerRadius:5,outerRadius:10,fill:d>=e?"yellow":"gray",stroke:"blue",strokeWidth:.2});b.add(g)}}function ia(){H.hide();M.setWidth(0);M.setHeight(0);F.hide();L.setWidth(0);L.setHeight(0);P.hide();J.setWidth(0);J.setHeight(0);n.removeChildren()}function t(b,a,c){switch(!0){case a<E:return"Level "+(a+1)+"-"+c;case a==w:return gTxtMsg.UserLevel+c;default:case a==B:return c+
" "+b}}function fa(b,a,c,d,e,g,f){b=new Kinetic.Rect({x:b,y:a,width:65,height:100,dragPos:{x:0,y:0},myId:c,myLevel:d,myType:f,myTabs:e,myItem:g});b.on("mousedown",function(a){a=this.getAbsolutePosition();this.setAttrs({dragPos:{x:a.x,y:a.y}})});b.on("click tap",function(a){a=this.getAbsolutePosition();var b=this.getAttr("dragPos");q(a.y==b.y?"MY-CLICK":a.y>b.y?"DOWN":"UP");if(a.y==b.y){a=this.getAttr("myId");var b=this.getAttr("myLevel"),c=this.getAttr("myType"),d=this.getAttr("myTabs"),e=this.getAttr("myItem"),
f=getBoardInfo(a,b),d=t(f.name,d,e);q("tableId = "+a+"level = "+b);null!=V&&(a={boardInfo:f,titleInfo:d,tableId:a,level:b,type:c},V(a,1),3==I?N=a:p=a,ia())}});b.on("mouseover",function(){document.body.style.cursor="pointer";q("tableId = "+this.getAttr("myId")+"level = "+this.getAttr("myLevel"))});b.on("mouseout",function(){document.body.style.cursor="default"});return b}function ma(b){J=new Kinetic.Stage({container:b,width:720,height:480});W=new Kinetic.Layer;J.add(W);P=new Kinetic.Layer;J.add(P);
n=new Kinetic.Group({width:720,height:1920,draggable:!0,dragBoundFunc:function(a){var b=this.getPosition().x;a=a.y;0<a?(a=0,Q.show()):a<G&&(a=G,R.show());q("x: "+b+" y: "+a);return{x:b,y:a}},dragPos:{x:0,y:0}});n.on("dragstart",function(a){document.body.style.cursor="url('./cursor/closedhand.cur'), auto";a=this.getPosition();this.setAttrs({dragPos:a})});n.on("dragend",function(a){document.body.style.cursor="url('./cursor/openhand.cur'), auto";a=this.getPosition();var b=this.getAttr("dragPos");q("DRAG: "+
(a.y==b.y?"CLICK":a.y>b.y?"DOWN":"UP")+" "+a.y);Q.hide();R.hide();if(0>a.y&&a.y>G&&a.y!=b.y){var d=a.y;switch(!0){case a.y>b.y&&40>-a.y%120:d+=120;break;case a.y<b.y&&40>-a.y%120:d+=120}d=Math.floor(d/120);d*=120;d!=a.y&&(null!=S&&S.pause(),S=new Kinetic.Tween({node:n,duration:.1,x:a.x,y:d,onFinish:function(){S=null}}),S.play())}this.getLayer().draw()});P.add(n);b=function(a){var b=a.detail?-a.detail:a.wheelDelta,b=0<b?120:-120;a=n.getPosition().x;b=n.getPosition().y+b;0<b?b=0:b<G&&(b=G);n.setPosition(a,
b);n.getLayer().draw()};document.addEventListener("mousewheel",b,!1);document.getElementById(X).addEventListener("DOMMouseScroll",b,!1)}function aa(b){var a=new Kinetic.Rect({width:720,height:480*b,fill:"#D0D0FF"});a.on("mouseover",function(){document.body.style.cursor="url('./cursor/openhand.cur'), auto"});a.on("mouseout",function(){document.body.style.cursor="default"});n.add(a);Q=new Kinetic.Line({points:[0,0,720,0],stroke:"red",strokeWidth:3});Q.hide();n.add(Q);R=new Kinetic.Line({points:[0,480*
b,720,480*b],stroke:"red",strokeWidth:3});R.hide();n.add(R)}function ba(b,a,c){var d=-1,e=-1;switch(!0){case c==TABS_TYPE.NORMAL:for(c=0;c<l.length;c++)if(l[c].tableId==b&&l[c].level==a){d=Math.floor(c/96);e=c-96*d+1;break}break;case c==TABS_TYPE.CLASSIC&&b==getClassicInfo().id:b=getClassicInfo().list;for(c=0;c<b.length;c++)if(b[c]==a){d=B;e=c+1;break}break;case c==TABS_TYPE.USER&&b==getUserInfo().id:d=w,e=a}return{tabsId:d,level:e}}var la=["white","white","#F6F633","#3333F6","#F63333"],l,V,M,H,L,
F,J,P,n,Q,R,S=null,E,K=-1,A=[],D=[],B,w,G=-1440,p,N=null,ja=this,W,O=12,ca=15;this.init=function(b,a,c,d,e,g){l=genBoardList();E=Math.ceil(l.length/96);6<E&&(E=6);B=E;w=E+1;ga=b;ha=a;X=c;V="undefined"==typeof g?null:g;Y=785<d?d:785;Z=560<e?e:560;T=780>=d?0:Math.floor(d-780)/2;U=555>=e?0:Math.floor(e-555)/2;b=T+20;a=U+15;c=b+10;d=a+10+25;document.getElementById(ga).style.cssText="top:0px; left:0px; position: absolute;";document.getElementById(ha).style.cssText="top:"+a+"px; left:"+b+"px; position: absolute;";
document.getElementById(X).style.cssText="top:"+d+"px; left:"+c+"px; position: absolute;";b=l[0].tableId;a=l[0].level;return p={boardInfo:getBoardInfo(b,a),titleInfo:t("",0,1),tableId:b,level:a,type:TABS_TYPE.NORMAL}};var ga,ha,X,Y,Z,T,U,ka=0,I;this.show=function(b){if(!ka){M=new Kinetic.Stage({container:ga,width:Y,height:Z});H=new Kinetic.Layer;M.add(H);var a=new Kinetic.Rect({x:10,y:10,width:Y-10,height:Z-10,cornerRadius:5,fill:"black",opacity:.6});H.add(a);a=new Kinetic.Rect({x:T,y:U,width:780,
height:555,cornerRadius:5,fill:"#F63333",stroke:"#F63333",strokeWidth:1,shadowColor:"black",shadowBlur:5,shadowOffset:5,shadowOpacity:.5});H.add(a);a=h();H.add(a);H.draw();m(ha);ma(X);ka=1}I=b;var c;3==I?(null==N&&(N=p),c=N):c=p;b=c.level;switch(c.type){case TABS_TYPE.NORMAL:a:{for(a=0;a<l.length;a++)if(l[a].tableId==c.tableId&&l[a].level==b){b=Math.floor(a/96);b={tabsId:b,page:Math.floor((a-96*b)/24)};break a}error("getNormalTabsPage(): design error !");b={tabsId:0,page:0}}break;case TABS_TYPE.CLASSIC:for(var a=
getClassicInfo().list,d=c=0;d<a.length;d++)if(a[d]==b){c=d;break}b={tabsId:B,page:Math.floor(c/24)};break;case TABS_TYPE.USER:b={tabsId:w,page:Math.floor((b-1)/24)};break;default:b={tabsId:0,page:0}}0>=getUserInfo().size?(A[w].hide(),D[w].hide()):(A[w].show(),D[w].show());H.show();M.setWidth(Y);M.setHeight(Z);F.show();L.setWidth(740);L.setHeight(525);P.show();J.setWidth(720);J.setHeight(480);k(b.tabsId,b.page)};this.changeSelectedBoard=function(b){var a=null;switch(b.type){case TABS_TYPE.NORMAL:for(var a=
b.table,c=b.level,d=0,e=0,g=1,f=0;f<l.length;f++)if(l[f].tableId==a&&l[f].level==c){d=f;e=Math.floor(d/96);g=d-96*e+1;break}a=l[d].tableId;c=l[d].level;a={boardInfo:getBoardInfo(a,c),titleInfo:t("",e,g),tableId:a,level:c,type:TABS_TYPE.NORMAL};break;case TABS_TYPE.CLASSIC:a=b.level;c=getClassicInfo().id;g=getClassicInfo().list;d=B;for(f=e=0;f<g.length;f++)if(g[f]==a){e=f;break}a=g[e];g=getBoardInfo(c,a);a={boardInfo:g,titleInfo:t(g.name,d,e+1),tableId:c,level:a,type:TABS_TYPE.CLASSIC};break;case TABS_TYPE.USER:a=
b.level,c=getUserInfo().id,e=getUserInfo().size,d=w,a>e?a=null:(e=getBoardInfo(c,a),a={boardInfo:e,titleInfo:t(e.name,d,a),tableId:c,level:a,type:TABS_TYPE.USER})}return null==a||a.boardInfo.board!=b.board?null:p=a};this.changeBoardByTabsLevel=function(b,a){if(0>b||1>a||96<a)return null;var c=96*b+(a-1);if(c>=l.length)return null;var d=l[c].tableId,c=l[c].level;return p=d={boardInfo:getBoardInfo(d,c),titleInfo:t("",b,a),tableId:d,level:c,type:TABS_TYPE.NORMAL}};this.changeBoardByClassicName=function(b){var a=
getClassicInfo().id,c=getClassicInfo().list,d=B,e,g,f;for(e=0;e<c.length&&!(g=c[e],f=getBoardInfo(a,g),f.name==b||"undefined"!=typeof f.classicAlias&&0<=f.classicAlias.indexOf(b));e++);return e>=c.length?null:p=b={boardInfo:f,titleInfo:t(f.name,d,e+1),tableId:a,level:g,type:TABS_TYPE.CLASSIC}};this.getNextLevel=function(){var b=p.tableId,a=p.level;switch(p.type){case TABS_TYPE.NORMAL:for(var c=0,d=0,e=1,g=0;g<l.length;g++)if(l[g].tableId==b&&l[g].level==a){++g<l.length&&(c=g,d=Math.floor(c/96),e=
c-96*d+1);break}b=l[c].tableId;a=l[c].level;p={boardInfo:getBoardInfo(b,a),titleInfo:t("",d,e),tableId:b,level:a,type:TABS_TYPE.NORMAL};break;case TABS_TYPE.CLASSIC:b=getClassicInfo().id;e=getClassicInfo().list;c=B;for(g=d=0;g<e.length;g++)if(e[g]==a){d=g+1;d>=e.length&&(d=0);break}a=e[d];e=getBoardInfo(b,a);p={boardInfo:e,titleInfo:t(e.name,c,d+1),tableId:b,level:a,type:TABS_TYPE.CLASSIC};break;case TABS_TYPE.USER:b=getUserInfo().id,d=getUserInfo().size,c=w,a+=1,a>d&&(a=1),d=getBoardInfo(b,a),p=
{boardInfo:d,titleInfo:t(d.name,c,a),tableId:b,level:a,type:TABS_TYPE.USER}}return p};this.setScore=function(b){return setBoardScore(p.tableId,p.level,b)};this.getHighScore=function(){return getBoardHighScore(p.tableId,p.level)};this.getAliasName=function(b,a,c){var d="",e=null,g=null;switch(c){case TABS_TYPE.NORMAL:var f=getClassicInfo().id;c=getClassicInfo().list;if(b==f)for(f=0;f<c.length;f++)if(c[f]==a){e=B;g=f+1;break}break;case TABS_TYPE.CLASSIC:for(f=0;f<l.length;f++)if(l[f].tableId==b&&l[f].level==
a){e=Math.floor(f/96);g=f-96*e+1;break}}null!=e&&(b=getBoardInfo(b,a),d=t(b.name,e,g));return d};this.tableLevel2TitleName=function(b,a){var c,d=-1;c=-1;getClassicInfo();getClassicInfo();var e=getUserInfo().id;if(b==e)return gTxtMsg.UserLevel+a;for(e=0;e<l.length;e++)if(l[e].tableId==b&&l[e].level==a){c=e;d=Math.floor(c/96);c=c-96*d+1;break}e=ja.getAliasName(b,a,TABS_TYPE.NORMAL);""!=e&&(e=" ("+e+") ");return t("",d,c)+e};this.maxLevelSize=function(){return 96}};
